{"version":3,"file":"reactivity.esm-bundler.js","sources":["../../shared/src/index.ts","../src/baseHandlers.ts","../src/reactive.ts"],"sourcesContent":["export function isObject(val){\n    return typeof val == 'object' && val !== null;\n}\n// ...\n\nexport let extend = Object.assign","import { extend } from \"@vue/shared\";\nfunction createGetter(isReadonly=false,shallow=false){\n    /**\n     * target 是原来的对象\n     * key 去取什么属性\n     * recevier 代理对象\n     */\n    return function get(target,key,recevier){\n    console.log(target,key,recevier)\n    }\n}\nfunction createSetter(shallow = false){\n    return function set(){\n      \n    }\n}\nconst get = createGetter(); // 不是仅读的也不是浅的\nconst shallowGet = createGetter(false,true)\nconst readonlyGet = createGetter(true);\nconst shallowReadonlyGet = createGetter(true,true);\nconst set = createSetter();\nconst shallowSet = createSetter(true); // readonly没有set\n// new Proxy(target,{})\nexport const mutableHandler = { // reactive中的get和set\n    get,\n    set\n}\nexport const shallowReactiveHandlers = {\n    get:shallowGet,\n    set:shallowSet\n}\nlet readonlySet = {\n    set(target,key){\n        console.warn(`cannot set ${JSON.stringify(target)} on  key ${key} falied`)\n    }\n}\nexport const readonlyHandlers = extend({\n    get:readonlyGet,\n},readonlySet)\nexport const shallowReadonlyHanlders = extend({\n    get:shallowReadonlyGet\n},readonlySet)\n\n// 取值 设置值 ","// 是否是浅的，默认是深度\n\nimport { isObject } from \"@vue/shared\";\nimport { mutableHandler, readonlyHandlers, shallowReactiveHandlers, shallowReadonlyHanlders } from \"./baseHandlers\";\n\n// 是否是仅读的 默认不是仅读的\n\nexport function reactive(target) {\n    return createReactiveObject(target, false, mutableHandler);\n}\nexport function shallowReactive(target) {\n    return createReactiveObject(target, false, shallowReactiveHandlers);\n}\nexport function readonly(target) {\n    return createReactiveObject(target, true, readonlyHandlers);\n}\nexport function shallowReadonly(target) {\n    return createReactiveObject(target, true, shallowReadonlyHanlders);\n}\n/**\n * \n * @param target 创建代理的目标\n * @param isReadonly 当前是不是仅读的\n * @param baseHandler 针对不同的方式创建不同的代理对象  \n */\n// weakMap(key只能是对象) map(key可以是其他类型)\nconst reactiveMap = new WeakMap(); // 目的是添加缓存\nconst readonlyMap = new WeakMap();\nfunction createReactiveObject(target, isReadonly, baseHandler) {\n    if(!isObject(target)){\n        return target;\n    }\n    const proxyMap = isReadonly? readonlyMap:reactiveMap\n    const existProxy = proxyMap.get(target);\n    if(existProxy){\n        return existProxy;// 如果已经代理过了，那就直接把上次的代理返回就可以的 \n    }\n    // 如果是对象 就做一个代理 new proxy\n    const proxy = new Proxy(target,baseHandler);\n    proxyMap.set(target,proxy);\n    return proxy;\n}\n\n// 数组，对象是如何劫持 effect 的实现 ref的实现。。。"],"names":[],"mappings":"SAAgB,QAAQ,CAAC,GAAG;IACxB,OAAO,OAAO,GAAG,IAAI,QAAQ,IAAI,GAAG,KAAK,IAAI,CAAC;AAClD,CAAC;AACD;AAEO,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM;;ACJjC,SAAS,YAAY,CAAC,UAAgB,EAAC,OAAa;;;;;;IAMhD,OAAO,SAAS,GAAG,CAAC,MAAM,EAAC,GAAG,EAAC,QAAQ;QACvC,OAAO,CAAC,GAAG,CAAC,MAAM,EAAC,GAAG,EAAC,QAAQ,CAAC,CAAA;KAC/B,CAAA;AACL,CAAC;AACD,SAAS,YAAY,CAAC,OAAe;IACjC,OAAO,SAAS,GAAG;KAElB,CAAA;AACL,CAAC;AACD,IAAM,GAAG,GAAG,YAAY,EAAE,CAAC;AAC3B,IAAM,UAAU,GAAG,YAAY,CAAW,CAAC,CAAA;AAC3C,IAAM,WAAW,GAAG,YAAY,CAAK,CAAC,CAAC;AACvC,IAAM,kBAAkB,GAAG,YAAY,CAAU,CAAC,CAAC;AACnD,IAAM,GAAG,GAAG,YAAY,EAAE,CAAC;AAC3B,IAAM,UAAU,GAAG,YAAY,CAAK,CAAC,CAAC;AACtC;AACO,IAAM,cAAc,GAAG;IAC1B,GAAG,KAAA;IACH,GAAG,KAAA;CACN,CAAA;AACM,IAAM,uBAAuB,GAAG;IACnC,GAAG,EAAC,UAAU;IACd,GAAG,EAAC,UAAU;CACjB,CAAA;AACD,IAAI,WAAW,GAAG;IACd,GAAG,YAAC,MAAM,EAAC,GAAG;QACV,OAAO,CAAC,IAAI,CAAC,gBAAc,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,iBAAY,GAAG,YAAS,CAAC,CAAA;KAC7E;CACJ,CAAA;AACM,IAAM,gBAAgB,GAAG,MAAM,CAAC;IACnC,GAAG,EAAC,WAAW;CAClB,EAAC,WAAW,CAAC,CAAA;AACP,IAAM,uBAAuB,GAAG,MAAM,CAAC;IAC1C,GAAG,EAAC,kBAAkB;CACzB,EAAC,WAAW,CAAC,CAAA;AAEd;;AC3CA;AAKA;SAEgB,QAAQ,CAAC,MAAM;IAC3B,OAAO,oBAAoB,CAAC,MAAM,EAAE,KAAK,EAAE,cAAc,CAAC,CAAC;AAC/D,CAAC;SACe,eAAe,CAAC,MAAM;IAClC,OAAO,oBAAoB,CAAC,MAAM,EAAE,KAAK,EAAE,uBAAuB,CAAC,CAAC;AACxE,CAAC;SACe,QAAQ,CAAC,MAAM;IAC3B,OAAO,oBAAoB,CAAC,MAAM,EAAE,IAAI,EAAE,gBAAgB,CAAC,CAAC;AAChE,CAAC;SACe,eAAe,CAAC,MAAM;IAClC,OAAO,oBAAoB,CAAC,MAAM,EAAE,IAAI,EAAE,uBAAuB,CAAC,CAAC;AACvE,CAAC;AACD;;;;;;AAMA;AACA,IAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAC;AAClC,IAAM,WAAW,GAAG,IAAI,OAAO,EAAE,CAAC;AAClC,SAAS,oBAAoB,CAAC,MAAM,EAAE,UAAU,EAAE,WAAW;IACzD,IAAG,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAC;QACjB,OAAO,MAAM,CAAC;KACjB;IACD,IAAM,QAAQ,GAAG,UAAU,GAAE,WAAW,GAAC,WAAW,CAAA;IACpD,IAAM,UAAU,GAAG,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;IACxC,IAAG,UAAU,EAAC;QACV,OAAO,UAAU,CAAC;KACrB;;IAED,IAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,EAAC,WAAW,CAAC,CAAC;IAC5C,QAAQ,CAAC,GAAG,CAAC,MAAM,EAAC,KAAK,CAAC,CAAC;IAC3B,OAAO,KAAK,CAAC;AACjB,CAAC;AAED;;;;"}